<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">

<title>Single Play Video Grid</title>

<style>
body {
    margin: 0;
    background: #000;
    color: #fff;
    font-family: system-ui, sans-serif;
}

.grid {
    max-width: 1200px;
    margin: auto;
    padding: 20px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 20px;
}

.card {
    background: #111;
    border-radius: 14px;
    overflow: hidden;
}

.preview {
    position: relative;
    aspect-ratio: 16/9;
    background: #000;
    cursor: pointer;
}

.preview canvas,
.preview video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}

.preview::after {
    content: "â–¶";
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 44px;
    background: rgba(0,0,0,.35);
    pointer-events: none;
}

.card.playing .preview::after {
    display: none;
}

.title {
    padding: 10px 12px;
    font-size: 15px;
    line-height: 1.4;
}
</style>
</head>

<body>

<div class="grid">

    <div class="card"
        data-video="https://video.twimg.com/amplify_video/2013133151929819136/vid/avc1/1280x720/OPgLYqMY91mvXkE7.mp4?tag=14"
        data-time="6">
        <div class="preview"></div>
        <div class="title">Judul Video Pertama</div>
    </div>

    <div class="card"
        data-video="https://video.twimg.com/amplify_video/2012575054714773505/vid/avc1/1280x720/cAd4h2oCIn5zxfOq.mp4?tag=21"
        data-time="10">
        <div class="preview"></div>
        <div class="title">Judul Video Kedua</div>
    </div>

    <div class="card"
        data-video="https://video.twimg.com/amplify_video/2010344361880641536/vid/avc1/1280x720/YUzeg-dr6oZvxBtu.mp4?tag=21"
        data-time="18">
        <div class="preview"></div>
        <div class="title">Judul Video Ketiga</div>
    </div>

</div>

<script>
let currentPlaying = null;

document.querySelectorAll('.card').forEach(card => {
    const src = card.dataset.video;
    const time = card.dataset.time;
    const preview = card.querySelector('.preview');

    // ===== PREVIEW STATIS =====
    const tempVideo = document.createElement('video');
    tempVideo.src = src;
    tempVideo.muted = true;
    tempVideo.playsInline = true;
    tempVideo.preload = 'auto';

    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    preview.appendChild(canvas);

    tempVideo.addEventListener('loadeddata', () => {
        tempVideo.currentTime = time;
    });

    tempVideo.addEventListener('seeked', () => {
        canvas.width = tempVideo.videoWidth;
        canvas.height = tempVideo.videoHeight;
        ctx.drawImage(tempVideo, 0, 0);
        tempVideo.remove();
    });

    // ===== PLAY VIDEO =====
    preview.addEventListener('click', () => {

        // stop video lain
        if (currentPlaying && currentPlaying !== card) {
            const oldPreview = currentPlaying.querySelector('.preview');
            const oldSrc = currentPlaying.dataset.video;
            const oldTime = currentPlaying.dataset.time;

            currentPlaying.classList.remove('playing');
            oldPreview.innerHTML = '';

            // balikin ke preview statis
            const v = document.createElement('video');
            v.src = oldSrc;
            v.muted = true;
            v.playsInline = true;
            v.preload = 'auto';

            const c = document.createElement('canvas');
            const x = c.getContext('2d');
            oldPreview.appendChild(c);

            v.addEventListener('loadeddata', () => {
                v.currentTime = oldTime;
            });

            v.addEventListener('seeked', () => {
                c.width = v.videoWidth;
                c.height = v.videoHeight;
                x.drawImage(v, 0, 0);
                v.remove();
            });
        }

        // play video baru
        if (card.classList.contains('playing')) return;

        card.classList.add('playing');
        preview.innerHTML = '';

        const player = document.createElement('video');
        player.src = src;
        player.controls = true;
        player.autoplay = true;
        player.playsInline = true;

        preview.appendChild(player);
        currentPlaying = card;
    });
});
</script>

</body>
</html>
