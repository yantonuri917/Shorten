<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shorten URL</title>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #4f46e5, #9333ea);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0;
    }

    .card {
      background: #fff;
      padding: 24px;
      border-radius: 14px;
      width: 100%;
      max-width: 420px;
      box-shadow: 0 20px 40px rgba(0,0,0,.15);
    }

    h1 {
      margin: 0 0 16px;
      font-size: 22px;
      text-align: center;
    }

    input {
      width: 100%;
      padding: 12px;
      margin-bottom: 10px;
      border-radius: 10px;
      border: 1px solid #ddd;
      font-size: 14px;
    }

    button {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: none;
      background: #4f46e5;
      color: #fff;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
    }

    button:disabled {
      opacity: .6;
      cursor: not-allowed;
    }

    #hasil {
      margin-top: 16px;
      text-align: center;
      font-size: 14px;
      word-break: break-all;
    }

    a {
      color: #4f46e5;
      text-decoration: none;
      font-weight: 600;
    }
  </style>
</head>
<body>

  <div class="card">
    <h1>ðŸ”— URL Shortener</h1>

    <input id="url" placeholder="https://contoh.com" />
    <input id="alias" placeholder="custom alias (opsional)" />

    <button id="btn" onclick="buat()">Shorten</button>

    <div id="hasil"></div>
  </div>

  <script>
    async function buat(){
      const url = document.getElementById('url').value.trim()
      const alias = document.getElementById('alias').value.trim()
      const hasil = document.getElementById('hasil')
      const btn = document.getElementById('btn')

      if(!url){
        hasil.innerText = 'URL tidak boleh kosong'
        return
      }

      btn.disabled = true
      btn.innerText = 'Memproses...'
      hasil.innerText = ''

      try {
        const r = await fetch('/api/create', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ url, alias })
        })

        const d = await r.json()

        if(d.error){
          hasil.innerText = d.error
        } else {
          const short = location.origin + '/' + d.code
          hasil.innerHTML = `<a href="${short}" target="_blank">${short}</a>`
        }
      } catch(e){
        hasil.innerText = 'Terjadi kesalahan'
      }

      btn.disabled = false
      btn.innerText = 'Shorten'
    }
  </script>

</body>
</html>
